---
title: Maps, charts and other possibilities
---
My new favorite Socrata visualization is the calendar.

## Socrata visualization types
Socrata is more than a place to dump raw tables, or at least
it tries to be; you can make various charts and maps, and you
can serve non-tabular information to some degree.

There are many ways that a particular dataset could be visualized.
Socrata has `length(unique(socrata$displayType))` ways.
Here they are.

```{r display_types}
socrata$displayType <- factor(socrata$displayType, levels = names(sort(table(socrata$displayType), decreasing = T)))
ggplot(socrata) + aes(x = displayType) + geom_bar() + coord_flip()
```

(A lot of them are empty, and I don't know what's up with that.)

## People actually use calendars
The calendar is
[what it sounds like](https://data.oregon.gov/dataset/Public-Meetings-3-Month-View-/4775-yg3b?).
And people actually use them.

```{r calendar_use}
ggplot(subset(socrata.distinct, displayType == 'calendar')) + aes(x = viewCount) + geom_histogram() +
  scale_x_continuous('Hits per calendar', labels = comma) +
  scale_y_continuous('Frequency', labels = comma) +
  ggtitle("Someone likes her calendar.")
```

Let's look at some specific calendars.

```{r calendar_use_2}
calendar.use <- subset(socrata, displayType == 'calendar')[c('portal', 'id', 'viewCount')]
calendar.use[order(calendar.use$viewCount, decreasing = T),][1:5,c('portal', 'id', 'viewCount')]
```

The biggest one is Missouri's [open meetings calendar](https://data.mo.gov/Government-Administration/Open-Meetings-Calendar/mahp-izvx?).
They also have a different view of the calendar [outside the portal](http://www.mo.gov/meetings/),
with an RSS feed from the Socrata portal. But I don't know how the calendar on Socrata got so many views.

It looks like some other portals are using calendars a lot too,
but usually with several separate calendars instead of one huge one.

```{r calendar_use_3}
ggplot(sqldf('select portal, sum(viewCount) AS "total.view.count", count(*) AS "number.of.calendars" FROM "calendar.use" GROUP BY portal;')) +
  aes(x = number.of.calendars, y = total.view.count, label = portal) + geom_text() +
  scale_x_log10('Number of calendars in the portal', breaks = c(1,5,25)) +
  scale_y_log10('Total hits across all calendars', labels = comma, breaks = 10^(2:6))
```

(Like [Oregon](https://data.oregon.gov/browse?limitTo=calendars))

## The cool thing about calendars
The cool thing about Socrata calendars is that you can download them
as a spreadsheet.

There are lots of different calendar programs. Most of them are way
better for calendaring than Socrata. They also typically have import
and export tools for transferring your calendar between different
calendar tools.

But as far as I can tell, none of the main calendar programs lets
you export to a format that isn't special to. As far as I can tell,
Outlook, iCal and Google Calendar can import and export iCal files (`.ics`).
This lets you move your data among calendar programs, but it's
harder to connect them to non-calendar datasets.

<!--
http://www.zimbra.com/desktop/help/en_US/Calendar/Exporting_your_iCal_calendar.htm
http://office.microsoft.com/en-us/outlook-help/transfer-calendars-between-outlook-and-google-calendar-HA010167495.aspx
-->

### Analyzing Missouri's calendar
With Socrata, I can download Missouri's calendar as CSV and load it into R,





### Finding other visualizations of the same data
You can even find examples of this within Socrata.
Look up all of Oregon's calendars,

```r
oregon.calendars <- subset(socrata, portal == 'data.oregon.gov' & displayType == 'calendar')
```

find out what datasets they visualize,

```r
barplot(sort(table(oregon.calendars$tableId), decreasing = T),
  horiz = T, las = 1, border = NA, col = 1,
  main = 'Oregon data tables that are visualized by calendars', ylab = '',
  xlab = 'Number of calendars visualizing the table'
)
```
look up one of the tables,

```r
table.429573 <- subset(socrata, tableId == 429573)[c('id', 'name', 'displayType')]
listify(table.429573)
```

and find that the calendar was just one of many visualizations of the same dataset!

### Combining calendars
I can also combine Oregon's and Missouri's public meetings calendars.

```r
oregon <- read.csv('http://data.oregon.gov/api/views/gs36-7t8m/rows.csv?accessType=DOWNLOAD', stringsAsFactors = F)
missouri <- read.csv('http://data.mo.gov/api/views/au6r-w9n3/rows.csv?accessType=DOWNLOAD', stringsAsFactors = F)
public.meetings <- rbind(
  missouri[c('Meeting.Body.Name', 'Committee', 'Begin.Date.Time', 'End.Date.Time', 'Address', 'City', 'State', 'Zip')],
  oregon[c('Agency..Board..Commission..Branch', 'Meeting.Title', 'Start.Date...Time', 'End.Date...Time', 'Meeting.Location', 'City', 'State')]
)
holidays <- as.Date(c(
	'20050117', '20050221', '20050530', '20050704', '20050905', '20051010', '20051111', '20051124', '20051226',
	'20060102', '20060116', '20060220', '20060529', '20060704', '20060904', '20061009', '20061110', '20061123', '20061225',
	'20070101', '20070115', '20070219', '20070528', '20070704', '20070903', '20071008', '20071112', '20071122', '20071225',
	'20080101', '20080121', '20080218', '20080526', '20080704', '20080901', '20081013', '20081111', '20081127', '20081225',
	'20090101', '20090119', '20090216', '20090525', '20090703', '20090907', '20091012', '20091111', '20091126', '20091225',
	'20100101', '20100118', '20100215', '20100531', '20100705', '20100906', '20101011', '20101111', '20101125', '20101224',
	'20101231', '20110117', '20110221', '20110530', '20110704', '20110905', '20111010', '20111111', '20111124', '20111226',
	'20120102', '20120116', '20120220', '20120528', '20120704', '20120903', '20121008', '20121112', '20121122', '20121225',
	'20130101', '20130121', '20130218', '20130527', '20130704', '20131014', '20131111', '20131128', '20131225'))

I'm quite excited that Socrata presents calendars as data.
To me, anything could be turned into data, and data could be turned into
[anything](http://csvsoundsystem.com). But a lot of people don't realize this,
and I see calendars as one of those things that people don't see as data.

## Prevent data from becoming closed

World Bank Open Finances made a
[form](https://finances.worldbank.org/dataset/Global-Open-Data-Calendar-Entry-Form/qdbh-rfd3?)
that populates an
[open data events calendar](https://finances.worldbank.org/dataset/Global-Open-Data-Calendar/g4sx-dwxc).

Typical services for hosting calendars, forms and ordinary websites make
data private by default. That is, I want good software that happens to
keep my data open. How can we make this happen?
I think part of the issue is that people don't see everything as data.

Socrata is mostly being used to help governments open data that they've
held for years in private silos. It is thus natural that Socrata would represent
calendars as tables on the open data portal, just like any other table, so you
can easily send calendar data through standard table-based analysis tools.


There's lots of siloed data in government, and we need better software and
methods for opening that up. But let's also make tools that prevent data from
becoming siloed in the first place.




I don't really know why people choose to use Socrata's calendars.
